# üé¨ Sentiment Analysis with LSTM (NLP)

![Python](https://img.shields.io/badge/Python-3.11-blue)
![PyTorch](https://img.shields.io/badge/PyTorch-2.2.0-red)
![scikit-learn](https://img.shields.io/badge/scikit--learn-1.3.0-green)
![License](https://img.shields.io/badge/license-MIT-lightgrey)

## –û –ø—Ä–æ–µ–∫—Ç–µ

–ü—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç **–∞–Ω–∞–ª–∏–∑ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ (sentiment analysis)** –æ—Ç–∑—ã–≤–æ–≤ –æ —Ñ–∏–ª—å–º–∞—Ö (IMDb) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –¥–≤—É–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–π LSTM-–º–æ–¥–µ–ª–∏ –Ω–∞ PyTorch. –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø–æ–ª–Ω—ã–π –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ü–∏–∫–ª —Ä–∞–±–æ—Ç—ã —Å —Ç–µ–∫—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏: –∑–∞–≥—Ä—É–∑–∫–∞, –æ—á–∏—Å—Ç–∫–∞, —Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è/–ª—ç–º–º–∞—Ç–∏–∑–∞—Ü–∏—è, –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Å–ª–æ–≤–∞—Ä—è, –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏, –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ (–º–æ–¥–µ–ª—å, —Å–ª–æ–≤–∞—Ä—å).

–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å –ø—Ä–æ–µ–∫—Ç–∞ ‚Äî –∞–∫–∫—É—Ä–∞—Ç–Ω–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π Jupyter Notebook (`NLP.ipynb`), –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–∞–∫ –ª–æ–∫–∞–ª—å–Ω–æ, —Ç–∞–∫ –∏ –≤ —Å—Ä–µ–¥–µ Google Colab –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.

---

## üîé –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞: –æ—á–∏—Å—Ç–∫–∞, –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è, –ª–µ–º–º–∞—Ç–∏–∑–∞—Ü–∏—è/—Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è.
- –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Å–ª–æ–≤–∞—Ä—è (vocab) –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤ –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏–Ω–¥–µ–∫—Å–æ–≤.
- –û–±—É—á–µ–Ω–∏–µ BiLSTM —Å —ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º–∏ –Ω–∞ PyTorch.
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `EarlyStopping` –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –ø–æ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π –º–µ—Ç—Ä–∏–∫–µ.
- –ü–æ–¥—Ä–æ–±–Ω–∞—è –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç—å: accuracy, precision/recall/f1, confusion matrix.
- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∫—Ä–∏–≤—ã—Ö –æ–±—É—á–µ–Ω–∏—è –∏ –º–∞—Ç—Ä–∏—Ü—ã –æ—à–∏–±–æ–∫.
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –∏ —Å–ª–æ–≤–∞—Ä—è –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö (–∏–Ω—Ñ–µ—Ä–µ–Ω—Å/REST API).

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è)

```
.
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ raw/IMDB Dataset.csv        # –∏—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îî‚îÄ‚îÄ processed/                  # –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ —Å–ª–æ–≤–∞—Ä—å
‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îî‚îÄ‚îÄ best_model.pth              # –æ–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å
‚îú‚îÄ‚îÄ results/                        # –≥—Ä–∞—Ñ–∏–∫–∏, –º–µ—Ç—Ä–∏–∫–∏ (png)
‚îú‚îÄ‚îÄ NLP.ipynb                       # –æ—Å–Ω–æ–≤–Ω–æ–π Jupyter Notebook
‚îú‚îÄ‚îÄ README.md                       # —ç—Ç–æ—Ç —Ñ–∞–π–ª
‚îî‚îÄ‚îÄ requirements.txt                # –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Å –≤–µ—Ä—Å–∏—è–º–∏
```

---

## ‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫ (–ª–æ–∫–∞–ª—å–Ω–æ)

**1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞**

```bash
git clone https://github.com/USERNAME/PROJECT_NAME.git
cd PROJECT_NAME
```

**2. –°–æ–∑–¥–∞–π—Ç–µ –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**

Linux / macOS:
```bash
python -m venv venv
source venv/bin/activate
```

Windows (PowerShell):
```powershell
python -m venv venv
venv\Scripts\Activate.ps1
```

**3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**

```bash
pip install -r requirements.txt
```

**4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ Jupyter Notebook**

```bash
jupyter notebook NLP.ipynb
```

---

## üß™ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å: –ø—Ä–∏–º–µ—Ä –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è (–∏–Ω—Ñ–µ—Ä–µ–Ω—Å)

–ù–∏–∂–µ ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–∏–º–µ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –∏ —Å–ª–æ–≤–∞—Ä—è –∏ –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –¥–ª—è –æ–¥–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞.

```python
import torch
import pickle
from pathlib import Path

# –ü—É—Ç—å –∫ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∞–º
models_dir = Path("models")
vocab_path = models_dir / "vocab.pkl"
model_path = models_dir / "best_model.pth"

# –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ª–æ–≤–∞—Ä—è
with open(vocab_path, "rb") as f:
    vocab = pickle.load(f)

# –ü—Ä–∏–º–µ—Ä —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ -> –∏–Ω–¥–µ–∫—Å—ã (–≤ –Ω–æ—É—Ç–±—É–∫–µ –µ—Å—Ç—å –ø–æ–ª–Ω–∞—è –≤–µ—Ä—Å–∏—è)
def text_to_sequence(text, vocab, max_len=200):
    tokens = text.lower().split()  # –ø—Ä–æ—Å—Ç–∞—è —Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è, –∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ —Ç—É, —á—Ç–æ –≤ –Ω–æ—É—Ç–±—É–∫–µ
    seq = [vocab.get(t, vocab.get("<UNK>", 1)) for t in tokens]
    if len(seq) < max_len:
        seq = seq + [vocab.get("<PAD>", 0)] * (max_len - len(seq))
    else:
        seq = seq[:max_len]
    return torch.tensor([seq], dtype=torch.long)

# –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ (–ø—Ä–∏–º–µ—Ä, –∞–¥–∞–ø—Ç–∏—Ä—É–π—Ç–µ –∫–ª–∞—Å—Å –º–æ–¥–µ–ª–∏ –ø–æ–¥ –≤–∞—à—É —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é)
device = torch.device("cuda" if torch.cuda.is_available() else "cpu")
model = torch.load(model_path, map_location=device)
model.eval()

sample_text = "This movie was absolutely fantastic ‚Äî great acting and story."
seq = text_to_sequence(sample_text, vocab)
with torch.no_grad():
    logits = model(seq.to(device))
    probs = torch.softmax(logits, dim=1)
    pred = torch.argmax(probs, dim=1).item()

print("Prediction:", pred, "Probabilities:", probs.cpu().numpy())
```

> –í –Ω–æ—É—Ç–±—É–∫–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –±–æ–ª–µ–µ –∞–∫–∫—É—Ä–∞—Ç–Ω–∞—è –≤–µ—Ä—Å–∏—è –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥–∞ –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–∏ ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ—ë –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.

---

## üìä –ü—Ä–∏–º–µ—Ä –æ–∂–∏–¥–∞–µ–º—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

```
              precision    recall  f1-score   support

    negative       0.88      0.90      0.89      5000
    positive       0.90      0.88      0.89      5000

    accuracy                           0.89     10000
```

–ò–ª–ª—é—Å—Ç—Ä–∞—Ü–∏–∏: —Ä–∞–∑–º–µ—Å—Ç–∏—Ç–µ –≤ `results/` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `confusion_matrix.png`, `training_plot.png`).

---

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (–≤–µ—Ä—Å–∏–∏ —É–∫–∞–∑–∞–Ω—ã –≤ `requirements.txt`):
- Python 3.11
- PyTorch, pandas, scikit-learn, numpy, NLTK, matplotlib, seaborn, tqdm

---

## üìà –ü–ª–∞–Ω—ã –ø–æ —É–ª—É—á—à–µ–Ω–∏—é

- –î–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—É—é —Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—é/—Å—É–±—Å–ª–æ–≤–Ω—É—é —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—é (SentencePiece / BytePair).
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ (GloVe / fastText) –∏–ª–∏ –¥–æ–æ–±—É—á–µ–Ω–∏–µ BERT-like –º–æ–¥–µ–ª–∏.
- –°–¥–µ–ª–∞—Ç—å REST API –¥–ª—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ (FastAPI + Uvicorn) –∏ Dockerfile –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏–∏.
- –î–æ–±–∞–≤–∏—Ç—å CI: —Ç–µ—Å—Ç—ã –∏ –ø—Ä–æ–≤–µ—Ä–∫—É —Å—Ç–∏–ª—è (pre-commit, flake8/isort).

---

## ‚öñÔ∏è –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π MIT ‚Äî –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ —Ñ–∞–π–ª–µ `LICENSE`.
